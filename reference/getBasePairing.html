<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Accessing Dot Bracket annotation — getBasePairing • Structstrings</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Accessing Dot Bracket annotation — getBasePairing"><meta property="og:description" content='getBasePairing converts a dot bracket annotation from a 
DotBracketString into a base pair table as 
DotBracketDataFrame. Base pairing is indicated by corresponding
numbers in the forward and reverse columns.
getDotBracket converts the dot bracket annotation from a
DotBracketDataFrame into a DotBracketString. If
the character colums is populated, the information from this column
will be used. If this is not desired set force = TRUE. However ,
beaware that this will result in a dot bracket annotation, which does not
necessarilly  matches the original dot bracket string it may have been
created from. It is rather the dot bracket string with the lowest number of
different loops and it will use the different dot bracket annotations one
after another. Example: "(((&amp;lt;&amp;lt;&amp;lt;&amp;gt;&amp;gt;&amp;gt;)))" will be returned as
(((((()))))). (((&amp;lt;&amp;lt;&amp;lt;)))&amp;gt;&amp;gt;&amp;gt; will be returned as
(((&amp;lt;&amp;lt;&amp;lt;)))&amp;gt;&amp;gt;&amp;gt;, ((([[[)))]]] will be eturned as
(((&amp;lt;&amp;lt;&amp;lt;)))&amp;gt;&amp;gt;&amp;gt;.
getLoopIndices converts the dot bracket annotation from a
DotBracketString or DotBracketDataFrame into a
LoopIndexList.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Structstrings</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.19.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/Structstrings.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/FelixErnst/Structstrings/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Accessing Dot Bracket annotation</h1>
    <small class="dont-index">Source: <a href="https://github.com/FelixErnst/Structstrings/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/FelixErnst/Structstrings/blob/HEAD/R/Structstrings-conversion.R" class="external-link"><code>R/Structstrings-conversion.R</code></a></small>
    <div class="hidden name"><code>getBasePairing.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>getBasePairing</code> converts a dot bracket annotation from a 
<code><a href="DotBracketString.html">DotBracketString</a></code> into a base pair table as 
<code><a href="DotBracketDataFrame.html">DotBracketDataFrame</a></code>. Base pairing is indicated by corresponding
numbers in the forward and reverse columns.</p>
<p><code>getDotBracket</code> converts the dot bracket annotation from a
<code><a href="DotBracketDataFrame.html">DotBracketDataFrame</a></code> into a <code><a href="DotBracketString.html">DotBracketString</a></code>. If
the <code>character</code> colums is populated, the information from this column
will be used. If this is not desired set <code>force = TRUE</code>. However ,
beaware that this will result in a dot bracket annotation, which does not
necessarilly  matches the original dot bracket string it may have been
created from. It is rather the dot bracket string with the lowest number of
different loops and it will use the different dot bracket annotations one
after another. Example: "(((&lt;&lt;&lt;&gt;&gt;&gt;)))" will be returned as
<code>(((((())))))</code>. <code>(((&lt;&lt;&lt;)))&gt;&gt;&gt;</code> will be returned as
<code>(((&lt;&lt;&lt;)))&gt;&gt;&gt;</code>, <code>((([[[)))]]]</code> will be eturned as
<code>(((&lt;&lt;&lt;)))&gt;&gt;&gt;</code>.</p>
<p><code>getLoopIndices</code> converts the dot bracket annotation from a
<code><a href="DotBracketString.html">DotBracketString</a></code> or <code>DotBracketDataFrame</code> into a
<code><a href="LoopIndexList.html">LoopIndexList</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getBasePairing</span><span class="op">(</span><span class="va">x</span>, compress <span class="op">=</span> <span class="cn">TRUE</span>, return.sequence <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">getDotBracket</span><span class="op">(</span><span class="va">x</span>, force <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">getLoopIndices</span><span class="op">(</span><span class="va">x</span>, <span class="va">bracket.type</span>, warn.type.drops <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for DotBracketString</span></span>
<span><span class="fu">getBasePairing</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for DotBracketStringSet</span></span>
<span><span class="fu">getBasePairing</span><span class="op">(</span><span class="va">x</span>, compress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for DotBracketDataFrame</span></span>
<span><span class="fu">getDotBracket</span><span class="op">(</span><span class="va">x</span>, force <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for DotBracketDataFrameList</span></span>
<span><span class="fu">getDotBracket</span><span class="op">(</span><span class="va">x</span>, force <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SimpleSplitDotBracketDataFrameList</span></span>
<span><span class="fu">getDotBracket</span><span class="op">(</span><span class="va">x</span>, force <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for CompressedSplitDotBracketDataFrameList</span></span>
<span><span class="fu">getDotBracket</span><span class="op">(</span><span class="va">x</span>, force <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for DotBracketString</span></span>
<span><span class="fu">getLoopIndices</span><span class="op">(</span><span class="va">x</span>, <span class="va">bracket.type</span>, warn.type.drops <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for DotBracketStringSet</span></span>
<span><span class="fu">getLoopIndices</span><span class="op">(</span><span class="va">x</span>, <span class="va">bracket.type</span>, warn.type.drops <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for DotBracketDataFrame</span></span>
<span><span class="fu">getLoopIndices</span><span class="op">(</span><span class="va">x</span>, <span class="va">bracket.type</span>, warn.type.drops <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for DotBracketDataFrameList</span></span>
<span><span class="fu">getLoopIndices</span><span class="op">(</span><span class="va">x</span>, <span class="va">bracket.type</span>, warn.type.drops <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SimpleSplitDotBracketDataFrameList</span></span>
<span><span class="fu">getLoopIndices</span><span class="op">(</span><span class="va">x</span>, <span class="va">bracket.type</span>, warn.type.drops <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for CompressedSplitDotBracketDataFrameList</span></span>
<span><span class="fu">getLoopIndices</span><span class="op">(</span><span class="va">x</span>, <span class="va">bracket.type</span>, warn.type.drops <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a <code><a href="DotBracketString.html">DotBracketString</a></code> or
<code><a href="DotBracketString.html">DotBracketStringSet</a></code> object</p></dd>


<dt>compress</dt>
<dd><p><code>getBasePairing</code>: whether to return a
<code>CompressedSplitDotBracketDataFrameList</code> or a
<code>SimpleSplitDotBracketDataFrameList</code></p></dd>


<dt>return.sequence</dt>
<dd><p>if the input is a <code>StructuredXStringSet</code>:
<code>TRUE</code>(default) or <code>FALSE</code>: Whether the sequence should be
returned in the <code>base</code> column.</p></dd>


<dt>force</dt>
<dd><p><code>getDotBracket</code>: Should the dot bracket string be
generated from the base pairing, if the <code>character</code> column is present?</p></dd>


<dt>bracket.type</dt>
<dd><p><code>getLoopIndices</code>: Which dot bracket annotation type
should be converted into loop indices? Only usable, if more than one is
present. (<code>1L = '()', 2L = '&lt;&gt;', 3L = '[]', 4L = '{}'</code>)</p></dd>


<dt>warn.type.drops</dt>
<dd><p><code>getLoopIndices</code>: <code>TRUE</code>(default) or
<code>FALSE</code>: Warn if more than one dot bracket annotation type is present
in the input?</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>getBasePairing</code>: 
The result is a <code><a href="DotBracketDataFrame.html">DotBracketDataFrame</a></code> with following columns:
pos, forward, reverse, character (and optionally the base column). If a
position is unpaired, forward and reverse will be <code>0</code>, otherwise it will
match the base paired positions.</p>


<p><code>getLoopIndices</code>: returns a <code><a href="LoopIndexList.html">LoopIndexList</a></code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dbs"</span>, package <span class="op">=</span> <span class="st">"Structstrings"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># conversion</span></span></span>
<span class="r-in"><span><span class="va">dbdf</span> <span class="op">&lt;-</span> <span class="fu">getBasePairing</span><span class="op">(</span><span class="va">dbs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># ... and the round trip</span></span></span>
<span class="r-in"><span><span class="va">dbs</span> <span class="op">&lt;-</span> <span class="fu">getDotBracket</span><span class="op">(</span><span class="va">dbdf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># loop indices per bracket type</span></span></span>
<span class="r-in"><span><span class="va">loopids</span> <span class="op">&lt;-</span> <span class="fu">getLoopIndices</span><span class="op">(</span><span class="va">dbs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># choose the bracket type manually, if necessary</span></span></span>
<span class="r-in"><span><span class="va">loopids</span> <span class="op">&lt;-</span> <span class="fu">getLoopIndices</span><span class="op">(</span><span class="va">dbs</span>, bracket.type <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># do not show warning if mulitple bracket types are present</span></span></span>
<span class="r-in"><span><span class="va">loopids</span> <span class="op">&lt;-</span> <span class="fu">getLoopIndices</span><span class="op">(</span><span class="va">dbs</span>, bracket.type <span class="op">=</span> <span class="fl">1L</span>, warn.type.drops <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Felix G.M. Ernst.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

